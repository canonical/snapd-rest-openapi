# SPDX-FileCopyrightText: 2025 Canonical Ltd
# SPDX-License-Identifier: GPL-3.0-only

type: object
required:
  - outcome
  - lifespan
properties:
  outcome:
    type: string
    enum:
      - allow
      - deny
  lifespan:
    type: string
    description: |-
      The lifespan for which the permission applies.

      timespan: the permission applies for the given duration specified by the
      duration field or until it is deleted

      session: the permission applies until the user logs out (specifically,
      until the systemd user session ends)

      forever: the permission applies until it is deleted
    enum:
      - timespan
      - session
      - forever
  duration:
    type: string
    description: |-
      The duration for which the permission is valid. Required if lifespan is
      timespan, otherwise must be omitted.
    format: Go duration
    externalDocs:
      description: |-
        Read more about how Go handles time and durations in the official Go
        Time package documentation.
      url: https://pkg.go.dev/time
    example: 7h30m
